{"id":"voelgoedevents-0xu","title":"Normalize actor shape to canonical 6-field actor across policies \u0026 calls","description":"Why:\nPhase 3 resources/policies must follow canonical actor shape (6 fields, user_id not id). Current codebase still uses actor(:id) and partial actors, which will cause inconsistent authorization and brittle tests.\n\nWhat:\n- Replace policy references actor(:id) -\u003e actor(:user_id)\n- Remove/replace partial/system actors with full 6-field actor map\n- Ensure actor is passed to final Ash create/update/read/destroy calls\n- Update fixtures/helpers/tests to build full actor consistently\n\nProof:\nmix format \u0026\u0026 mix compile \u0026\u0026 mix test","status":"in_progress","priority":0,"issue_type":"bug","created_at":"2025-12-16T10:11:33.232970186+02:00","updated_at":"2025-12-16T10:17:00.500055748+02:00","labels":["ash-3","blocking","rbac"],"dependencies":[{"issue_id":"voelgoedevents-0xu","depends_on_id":"voelgoedevents-m4e","type":"discovered-from","created_at":"2025-12-16T10:12:29.619475585+02:00","created_by":"daemon"},{"issue_id":"voelgoedevents-0xu","depends_on_id":"voelgoedevents-c1q","type":"discovered-from","created_at":"2025-12-16T19:13:31.190867536+02:00","created_by":"daemon"}]}
{"id":"voelgoedevents-33g","title":"Fix auth login rate limit regression tests","description":"Progress (2025-12-16):\n- audit_change.ex: actor extraction is now KeyError-safe (no dot-access) and supports map/keyword contexts/private contexts via fetch/2 helper.\n- audit_change.ex: audit params are filtered by accepted inputs for the audit_resource :create action, supporting both atom and string keys.\n- audit_change_test.exs: updated failure assertion to expect Ash.Error.Unknown (Ash 3 wraps errors) while still asserting message contains \"Audit logging failed\".\n\nVerification:\n- mix test test/voelgoedevents/ash/changes/audit_change_test.exs --seed 0\n  Result: 2 tests, 0 failures.\n\nNotes:\n- Only warnings remain (unused aliases, domain inclusion warning in test domain).","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-16T07:38:53.475697877+02:00","updated_at":"2025-12-16T20:30:24.725420262+02:00","closed_at":"2025-12-16T20:30:24.725420262+02:00","close_reason":"AuditChange tests green; actor_id required resolved; Ash 3 error wrapping handled in test.","labels":["auth","rate-limit","test"]}
{"id":"voelgoedevents-c1q","title":"Phase 3 Readiness Gate: Ash 3.x Tenant + Policies + Audit Stabilization","description":"Closed voelgoedevents-g05: FilterByTenant tests now assert Ash 3 predicate semantics (org_id_ref?/1).","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-16T19:12:27.020809145+02:00","updated_at":"2025-12-16T19:29:30.604046495+02:00","labels":["ash3","phase3","stabilization"]}
{"id":"voelgoedevents-cti","title":"Silence Inspect protocol consolidation warnings in audit_change_test","description":"Completed (2025-12-16):\n- Implemented Option 2: fully qualified domain module references (Voelgoedevents.Ash.Changes.AuditChangeTest.TestDomain) to avoid Spark DSL module errors.\n- audit_change_test.exs now passes domain module explicitly where used.\n\nVerification:\n- mix test test/voelgoedevents/ash/changes/audit_change_test.exs --seed 0\n  Result: 2 tests, 0 failures.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T21:03:04.556375622+02:00","updated_at":"2025-12-16T22:16:35.057340712+02:00","closed_at":"2025-12-16T22:16:35.057340712+02:00","close_reason":"Option 2 applied: fully qualified TestDomain usage; audit_change_test passes cleanly."}
{"id":"voelgoedevents-g05","title":"FilterByTenant tests: match Ash 3 predicate shape (Eq left/right)","description":"Done:\n- Updated FilterByTenant tests to assert Ash 3 Eq predicate semantics using org_id_ref?/1 helper (supports atom and Ash.Query.Ref forms).\nProof:\n- mix test test/voelgoedevents/ash/preparations/filter_by_tenant_test.exs --seed 0 (PASS)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T19:15:59.019199721+02:00","updated_at":"2025-12-16T19:29:30.554977012+02:00","closed_at":"2025-12-16T19:29:30.554977012+02:00","close_reason":"Done","labels":["ash3","tenant","tests"],"dependencies":[{"issue_id":"voelgoedevents-g05","depends_on_id":"voelgoedevents-c1q","type":"discovered-from","created_at":"2025-12-16T19:17:23.436605332+02:00","created_by":"daemon"}]}
{"id":"voelgoedevents-lq8","title":"Silence warnings in audit_change_test.exs (unused alias + TestDomain inclusion)","description":"Completed (2025-12-16):\n- Removed unused alias AuditChange in audit_change_test.exs.\n- Updated TestDomain to use Ash.Domain with validate_config_inclusion?: false to silence domain inclusion warning.\n\nVerification:\n- mix test test/voelgoedevents/ash/changes/audit_change_test.exs --seed 0\n  Result: 2 tests, 0 failures.\n\nNotes:\n- Remaining warnings are protocol consolidation warnings (Inspect) for test-defined modules; separate concern.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:36:41.001609632+02:00","updated_at":"2025-12-16T21:00:28.395661909+02:00","closed_at":"2025-12-16T21:00:28.395661909+02:00","close_reason":"Silenced test warnings (unused alias + TestDomain inclusion); tests green."}
{"id":"voelgoedevents-m4e","title":"Phase 3 start: normalize actor shape + implement Venue (with migration + tests)","description":"","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-16T10:10:21.594397099+02:00","updated_at":"2025-12-16T10:11:24.080672156+02:00","labels":["ash-3","phase-3","rbac","venues"],"dependencies":[{"issue_id":"voelgoedevents-m4e","depends_on_id":"voelgoedevents-c1q","type":"discovered-from","created_at":"2025-12-16T19:13:31.23834465+02:00","created_by":"daemon"}]}
{"id":"voelgoedevents-u2l","title":"AuditChange: fix context access (no map/Access on Ash.Resource.Change.Context)","description":"Progress (2025-12-16):\n- Added actor_id normalization (binary/int/map-\u003eid) and string coercion.\n- Made actor extraction KeyError-safe (no dot-access).\n- Added accepted-input filtering when calling Ash.create/3 for audit log resources, removing \"No such input ...\" errors.\n\nCurrent status:\n- Tests still fail: \"attribute actor_id is required\" when creating SuccessAuditLog.\n- Strong suspicion: after_changeset.context may be a KEYWORD LIST (not a map), so Map.get(ctx, :actor) returns nil and actor_id stays nil.\n\nNext:\n- Update actor extraction to support map OR keyword contexts (Map.get vs Keyword.get).\n- Also check :private contexts for actor.","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-12-16T19:29:39.535603949+02:00","updated_at":"2025-12-16T20:21:04.55363987+02:00","labels":["ash3","audit","changes"],"dependencies":[{"issue_id":"voelgoedevents-u2l","depends_on_id":"voelgoedevents-c1q","type":"discovered-from","created_at":"2025-12-16T19:30:15.822285717+02:00","created_by":"daemon"}]}
{"id":"voelgoedevents-uij","title":"Phase 3.1.1 Venue: migration + resource + policies + tests","description":"","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T10:11:33.281014137+02:00","updated_at":"2025-12-16T10:11:33.281014137+02:00","labels":["phase-3","venues"],"dependencies":[{"issue_id":"voelgoedevents-uij","depends_on_id":"voelgoedevents-m4e","type":"discovered-from","created_at":"2025-12-16T10:12:29.665074954+02:00","created_by":"daemon"},{"issue_id":"voelgoedevents-uij","depends_on_id":"voelgoedevents-c1q","type":"discovered-from","created_at":"2025-12-16T19:13:31.282905596+02:00","created_by":"daemon"}]}
{"id":"voelgoedevents-yej","title":"Remove unused aliases in audit_change.ex","description":"Completed (2025-12-16):\n- Removed unused aliases AuditDomain and AuditLog from lib/voelgoedevents/ash/changes/audit_change.ex.\n\nVerification:\n- mix test test/voelgoedevents/ash/changes/audit_change_test.exs --seed 0\n  Result: 2 tests, 0 failures.\n  Note: Remaining warnings are in the test file (unused alias AuditChange, TestDomain config inclusion), not in audit_change.ex.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-16T20:32:45.671352146+02:00","updated_at":"2025-12-16T20:36:30.122438191+02:00","closed_at":"2025-12-16T20:36:30.122438191+02:00","close_reason":"Removed unused aliases in audit_change.ex; maintenance warning cleanup."}
